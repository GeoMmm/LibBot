<!DOCTYPE html>
<!-- saved from url=(0125)https://ashy-meadow-0cccf0703.azurestaticapps.net/?likert=5&SID=MjAyMTEwMTAxOTA2MjE3MQ==&UID=Z2VvcmdlLm11YW1tYXJAd2ZwLm9yZw== -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252"><meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Feedback to LRC</title>
  <link rel="stylesheet" href="./LRCFeedbackLikert_files/jquery-ui.css">
  <link rel="stylesheet" href="./LRCFeedbackLikert_files/style.css">
  <script src="./LRCFeedbackLikert_files/jquery-1.12.4.js.download"></script>
  <script src="./LRCFeedbackLikert_files/jquery-ui.js.download"></script>
<script type="text/javascript">
        var message="";
        var likert="";
        var SID="";
	var UID="";
	  
	
function postit(button)
{
if (button) {
  message=document.getElementById("message").value;
  likert=document.getElementById("likert").value;
  document.getElementById('ReviewForm').style.display='none';
 }

if (isNaN(likert)) 
{	document.getElementById("ErrorMessage").innerHTML="Doesn't look like a valid number. Let's see what the Bot replies..."}
else
{		if (parseInt(likert)<1 || parseInt(likert)>5) document.getElementById("ErrorMessage").innerHTML="Doesn't look between 1 and 5. Let's see what the Bot replies...";
	if (parseFloat(likert)!==parseInt(likert)) document.getElementById("ErrorMessage").innerHTML="Doesn't look like an integer. Let's see what the Bot replies...";
}


var payload = "{\r\n   \"likert\": \""+ likert + "\",\r\n \"SID\": \""+ SID + "\",\r\n \"UID\": \""+ UID + "\" ,\r\n  \"message\": \""+ message + "\" \r\n }";
console.log("payload: " + payload);
var settings = {
  "async": true,
  "crossDomain": true,
  "url": "https://prod-32.westeurope.logic.azure.com:443/workflows/dbd1867136824192aa94431ef8319b7c/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=vrmv7Fe8WjjUhJdr0TQ3fHz5aC25YH3S4wCF9iEYb-c",
  "method": "POST",
    beforeSend: function(){
		document.getElementById("StatusMessage").innerHTML="Sending your rating to the LRC...";
        },
        success: function(data) {
		console.log("success: "+data.responseText);
		document.getElementById("StatusMessage").innerHTML=data.responseText;
		document.getElementById('ReviewForm').style.display='block';
        },				
		error: function(data,statustext) {
		console.log("error: "+data.responseText);
		document.getElementById("StatusMessage").innerHTML=data.responseText;
		document.getElementById('ReviewForm').style.display='block';

			},

     dataType: "json",
	 
  "headers": {
    "Content-Type": "application/json",
    "cache-control": "no-cache"
  },
  "processData": false,
  "data": payload
};

$.ajax(settings);
}

function startit() {
document.getElementById("ErrorMessage").innerHTML="Thank you for providing feedback"
const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
likert = urlParams.get('likert');
SID = urlParams.get('SID');
UID = urlParams.get('UID');
var message="";

postit(false);


document.getElementById("likert").value = likert;

}

</script>

  </head>
<body>
<table border="0"><tr><td><img src="https://res.cloudinary.com/wfplrc/image/upload/c_scale,w_225/v1634070601/LRC%20Website/WFPnewlogo_english_standard_BLUE_RGB.png"></td><td><font size="6" face="Open Sans">Library and Research Centre<BR>Feedback System</td></tr></table>
<h1 name="ErrorMessage" id="ErrorMessage">Thank you for providing feedback</h1>
<br>

<h2 name="StatusMessage" id="StatusMessage">George MUAMMAR, thank you for review.<br><br>We have received 1 ratings for this, with an overall average of 0 out of 5.</h2>   
<div id="loading">&nbsp;</div>
<div name="ReviewForm" id="ReviewForm" visibility="hidden" style="display: block;">        
<hr><br><br>If you like, take a minute to provide a more accurate rating and send a message to the LRC<br><br>Enter your rating (1-5) <input type="text" id="likert" name="likert"><br><br>Type a message here, if you like<br><textarea name="message" id="message" rows="3" cols="30"></textarea><br><input type="submit" value="Update your feedback" onclick="postit(true);"><br>
</div>

<script>
document.getElementById('ReviewForm').style.display='none';
startit();
</script>
</body></html>
